var version="9.5.0";var active_contextmenu=true;if(loading_bar){if(!(/MSIE (\d+\.\d+);/.test(navigator.userAgent))){window.addEventListener("DOMContentLoaded",function(){$("body").queryLoader2({backgroundColor:"none",minimumTime:100,percentage:true})})}else{$(document).ready(function(){$("body").queryLoader2({backgroundColor:"none",minimumTime:100,percentage:true})})}}$(document).ready(function(){if(active_contextmenu){$.contextMenu({selector:"figure:not(.back-directory), .list-view2 figure:not(.back-directory)",autoHide:true,build:function(d){d.addClass("selected");var e={callback:function(k,i){switch(k){case"copy_url":var f="";f+=$("#base_url").val()+$("#cur_dir").val();add=d.find("a.link").attr("data-file");if(add!=""&&add!=null){f+=add}add=d.find("h4 a.folder-link").attr("data-file");if(add!=""&&add!=null){f+=add}bootbox.alert('URL:<br/><br/><input type="text" style="height:30px; width:100%;" value="'+f+'" />');break;case"unzip":var f=$("#sub_folder").val()+$("#fldr_value").val()+d.find("a.link").attr("data-file");$.ajax({type:"POST",url:"ajax_calls.php?action=extract",data:{path:f}}).done(function(l){if(l!=""){bootbox.alert(l)}else{window.location.href=$("#refresh").attr("href")+"&"+new Date().getTime()}});break;case"edit_img":var h=d.attr("data-name");var j=$("#base_url_true").val()+$("#cur_dir").val()+h;$("#aviary_img").attr("data-name",h);$("#aviary_img").attr("src",j).load(launchEditor("aviary_img",j));break;case"duplicate":var g=d.find("h4").text().trim();bootbox.prompt($("#lang_duplicate").val(),$("#cancel").val(),$("#ok").val(),function(l){if(l!==null){l=fix_filename(l);if(l!=g){var m=d.find(".rename-file");execute_action("duplicate_file",m.attr("data-path"),m.attr("data-thumb"),l,m,"apply_file_duplicate")}}},g);break;case"copy":copy_cut_clicked(d,"copy");break;case"cut":copy_cut_clicked(d,"cut");break;case"paste":paste_to_this_dir();break;case"chmod":chmod(d);break;case"edit_text_file":edit_text_file(d);break}},items:{}};if((d.find(".img-precontainer-mini .filetype").hasClass("png")||d.find(".img-precontainer-mini .filetype").hasClass("jpg")||d.find(".img-precontainer-mini .filetype").hasClass("jpeg"))&&image_editor){e.items.edit_img={name:$("#lang_edit_image").val(),icon:"edit_img",disabled:false}}e.items.copy_url={name:$("#lang_show_url").val(),icon:"url",disabled:false};if(d.find(".img-precontainer-mini .filetype").hasClass("zip")||d.find(".img-precontainer-mini .filetype").hasClass("tar")||d.find(".img-precontainer-mini .filetype").hasClass("gz")){e.items.unzip={name:$("#lang_extract").val(),icon:"extract",disabled:false}}if(d.find(".img-precontainer-mini .filetype").hasClass("edit-text-file-allowed")){e.items.edit_text_file={name:$("#lang_edit_file").val(),icon:"edit",disabled:false}}if(!d.hasClass("directory")&&$("#duplicate").val()==1){e.items.duplicate={name:$("#lang_duplicate").val(),icon:"duplicate",disabled:false}}if(!d.hasClass("directory")&&$("#copy_cut_files_allowed").val()==1){e.items.copy={name:$("#lang_copy").val(),icon:"copy",disabled:false};e.items.cut={name:$("#lang_cut").val(),icon:"cut",disabled:false}}else{if(d.hasClass("directory")&&$("#copy_cut_dirs_allowed").val()==1){e.items.copy={name:$("#lang_copy").val(),icon:"copy",disabled:false};e.items.cut={name:$("#lang_cut").val(),icon:"cut",disabled:false}}}if($("#clipboard").val()!=0&&!d.hasClass("directory")){e.items.paste={name:$("#lang_paste_here").val(),icon:"clipboard-apply",disabled:false}}if(!d.hasClass("directory")&&$("#chmod_files_allowed").val()==1){e.items.chmod={name:$("#lang_file_permission").val(),icon:"key",disabled:false}}else{if(d.hasClass("directory")&&$("#chmod_dirs_allowed").val()==1){e.items.chmod={name:$("#lang_file_permission").val(),icon:"key",disabled:false}}}e.items.sep="----";e.items.info={name:"<strong>"+$("#lang_file_info").val()+"</strong>",disabled:true};e.items.name={name:d.attr("data-name"),icon:"label",disabled:true};if(d.attr("data-type")=="img"){e.items.dimension={name:d.find(".img-dimension").html(),icon:"dimension",disabled:true}}e.items.size={name:d.find(".file-size").html(),icon:"size",disabled:true};e.items.date={name:d.find(".file-date").html(),icon:"date",disabled:true};return e},events:{hide:function(d){$("figure").removeClass("selected")}}});$(document).on("contextmenu",function(d){if(!$(d.target).is("figure")){return false}})}$("#full-img").on("click",function(){$("#previewLightbox").lightbox("hide")});$("ul.grid").on("click",".modalAV",function(d){_this=$(this);d.preventDefault();$("#previewAV").removeData("modal");$("#previewAV").modal({backdrop:"static",keyboard:false});if(_this.hasClass("audio")){$(".body-preview").css("height","80px")}else{$(".body-preview").css("height","345px")}$.ajax({url:_this.attr("data-url"),success:function(e){$(".body-preview").html(e)}})});$("ul.grid").on("click",".file-preview-btn",function(d){_this=$(this);d.preventDefault();$.ajax({url:_this.attr("data-url"),success:function(e){bootbox.alert(e)}})});$("input[name=radio-sort]").on("click",function(){var d=$(this).attr("data-item");$(".filters label").removeClass("btn-inverse");$(".filters label").find("i").removeClass("icon-white");$("#filter-input").val("");$("#"+d).addClass("btn-inverse");$("#"+d).find("i").addClass("icon-white");if(d=="ff-item-type-all"){$(".grid li").show(300)}else{if($(this).is(":checked")){$(".grid li").not("."+d).hide(300);$(".grid li."+d).show(300)}}});var c=(function(){var d=0;return function(f,e){clearTimeout(d);d=setTimeout(f,e)}})();if(parseInt($("#file_number").val())>parseInt($("#file_number_limit_js").val())){var b=false}else{var b=true}$("#filter-input").on("keyup",function(){$(".filters label").removeClass("btn-inverse");$(".filters label").find("i").removeClass("icon-white");$("#ff-item-type-all").addClass("btn-inverse");$("#ff-item-type-all").find("i").addClass("icon-white");var d=fix_filename($(this).val());$(this).val(d);c(function(){if(b){$("ul.grid li").each(function(){var e=$(this);if(d!=""&&e.attr("data-name").toString().toLowerCase().indexOf(d.toLowerCase())==-1){e.hide(100)}else{e.show(100)}})}},300)}).keypress(function(d){if(d.which==13){$("#filter").trigger("click")}});$("#filter").on("click",function(){var d=fix_filename($("#filter-input").val());window.location.href=$("#current_url").val()+"&filter="+d});$("#info").on("click",function(){bootbox.alert('<center><img src="img/logo.png" alt="responsive filemanager"/><br/><br/><p><strong>RESPONSIVE filemanager v.'+version+'</strong><br/><a href="http://www.responsivefilemanager.com">responsivefilemanager.com</a></p><br/><p>Copyright Â© <a href="http://www.tecrail.com" alt="tecrail">Tecrail</a> - Alberto Peripolli. All rights reserved.</p><br/><p>License<br/><small><img alt="Creative Commons License" style="border-width:0" src="http://responsivefilemanager.com/license.php" /><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>.</small></p></center>')});$("#change_lang_btn").on("click",function(){change_lang()});$("#uploader-btn").on("click",function(){var d=$("#sub_folder").val()+$("#fldr_value").val()+"/";d=d.substring(0,d.length-1);$("#iframe-container").html($("<iframe />",{name:"JUpload",id:"uploader_frame",src:"uploader/index.php?path="+d,frameborder:0,width:"100%",height:360}))});$(".upload-btn").on("click",function(){$(".uploader").show(500)});var a=$("#descending").val()==="true";$(".sorter").on("click",function(){_this=$(this);a=!a;if(b){$.ajax({url:"ajax_calls.php?action=sort&sort_by="+_this.attr("data-sort")+"&descending="+a}).done(function(d){});sortUnorderedList("ul.grid",a,"."+_this.attr("data-sort"));$(" a.sorter").removeClass("descending").removeClass("ascending");if(a){$(".sort-"+_this.attr("data-sort")).addClass("descending")}else{$(".sort-"+_this.attr("data-sort")).addClass("ascending")}}else{window.location.href=$("#current_url").val()+"&sort_by="+_this.attr("data-sort")+"&descending="+a}});$(".close-uploader").on("click",function(){$(".uploader").hide(500);setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+new Date().getTime()},420)});$("ul.grid").on("click",".preview",function(){var d=$(this);$("#full-img").attr("src",decodeURIComponent(d.attr("data-url")));if(d.hasClass("disabled")==false){show_animation()}return true});$("body").on("keypress",function(d){var f=String.fromCharCode(d.which);if(f=="'"||f=='"'||f=="\\"||f=="/"){return false}});$("ul.grid").on("click",".rename-file",function(){var g=$(this);var d=g.parent().parent().parent();var f=d.find("h4");var e=$.trim(f.text());bootbox.prompt($("#rename").val(),$("#cancel").val(),$("#ok").val(),function(h){if(h!==null){h=fix_filename(h);if(h!=e){execute_action("rename_file",g.attr("data-path"),g.attr("data-thumb"),h,d,"apply_file_rename")}}},e)});$("ul.grid").on("click",".rename-folder",function(){var g=$(this);var d=g.parent().parent().parent();var f=d.find("h4");var e=$.trim(f.text());bootbox.prompt($("#rename").val(),$("#cancel").val(),$("#ok").val(),function(h){if(h!==null){h=fix_filename(h).replace(".","");if(h!=e){execute_action("rename_folder",g.attr("data-path"),g.attr("data-thumb"),h,d,"apply_folder_rename")}}},e)});$("ul.grid").on("click",".delete-file",function(){var d=$(this);bootbox.confirm(d.attr("data-confirm"),$("#cancel").val(),$("#ok").val(),function(e){if(e==true){execute_action("delete_file",d.attr("data-path"),d.attr("data-thumb"),"","","");d.parent().parent().parent().parent().remove()}})});$("ul.grid").on("click",".delete-folder",function(){var d=$(this);bootbox.confirm(d.attr("data-confirm"),$("#cancel").val(),$("#ok").val(),function(e){if(e==true){execute_action("delete_folder",d.attr("data-path"),d.attr("data-thumb"),"","","");d.parent().parent().parent().remove()}})});$(".create-file-btn").on("click",function(){create_text_file()});$(".new-folder").on("click",function(){bootbox.prompt($("#insert_folder_name").val(),$("#cancel").val(),$("#ok").val(),function(d){if(d!==null){d=fix_filename(d).replace(".","");var f=$("#sub_folder").val()+$("#fldr_value").val()+d;var e=$("#cur_dir_thumb").val()+d;$.ajax({type:"POST",url:"execute.php?action=create_folder",data:{path:f,path_thumb:e}}).done(function(g){setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+new Date().getTime()},300)})}},$("#new_folder").val())});$(".view-controller button").on("click",function(){var e=$(this);$(".view-controller button").removeClass("btn-inverse");$(".view-controller i").removeClass("icon-white");e.addClass("btn-inverse");e.find("i").addClass("icon-white");$.ajax({url:"ajax_calls.php?action=view&type="+e.attr("data-value")}).done(function(f){if(f!=""){bootbox.alert(f)}});if(typeof $("ul.grid")[0]!=="undefined"&&$("ul.grid")[0]){$("ul.grid")[0].className=$("ul.grid")[0].className.replace(/\blist-view.*?\b/g,"")}if(typeof $(".sorter-container")[0]!=="undefined"&&$(".sorter-container")[0]){$(".sorter-container")[0].className=$(".sorter-container")[0].className.replace(/\blist-view.*?\b/g,"")}var d=e.attr("data-value");$("#view").val(d);$("ul.grid").addClass("list-view"+d);$(".sorter-container").addClass("list-view"+d);if(e.attr("data-value")>=1){fix_colums(14)}else{$("ul.grid li").css("width",126);$("ul.grid figure").css("width",122)}});if(!Modernizr.touch){$(".tip").tooltip({placement:"bottom"});$(".tip-top").tooltip({placement:"top"});$(".tip-left").tooltip({placement:"left"});$(".tip-right").tooltip({placement:"right"});$("body").addClass("no-touch")}else{$("#help").show();$(".box:not(.no-effect)").swipe({swipeLeft:swipe_reaction,swipeRight:swipe_reaction,threshold:30})}$(".paste-here-btn").on("click",function(){if($(this).hasClass("disabled")==false){paste_to_this_dir()}});$(".clear-clipboard-btn").on("click",function(){if($(this).hasClass("disabled")==false){clear_clipboard()}});if(!Modernizr.csstransforms){$("figure").on("mouseover",function(){if($("#view").val()==0&&$("#main-item-container").hasClass("no-effect-slide")===false){$(this).find(".box:not(.no-effect)").animate({top:"-26px"},{queue:false,duration:300})}});$("figure").on("mouseout",function(){if($("#view").val()==0){$(this).find(".box:not(.no-effect)").animate({top:"0px"},{queue:false,duration:300})}})}$(window).resize(function(){fix_colums(28)});fix_colums(14);$("ul.grid").on("click",".link",function(){var d=$(this);window[d.attr("data-function")](d.attr("data-file"),d.attr("data-field_id"))});if($("#clipboard").val()==1){toggle_clipboard(true)}else{toggle_clipboard(false)}$("li.dir, li.file").draggable({revert:true,distance:20,cursor:"move",helper:function(){$(this).find("figure").find(".box").css("top","0px");var d=$(this).clone().css("z-index",1000).find(".box").css("box-shadow","none").css("-webkit-box-shadow","none").parent().parent();$(this).addClass("selected");return d},start:function(){if($("#view").val()==0){$("#main-item-container").addClass("no-effect-slide")}},stop:function(){$(this).removeClass("selected");if($("#view").val()==0){$("#main-item-container").removeClass("no-effect-slide")}}});$("li.dir").droppable({accept:"ul.grid li",activeClass:"ui-state-highlight",hoverClass:"ui-state-highlight",drop:function(d,e){drag_n_drop_paste(e.draggable.find("figure"),$(this).find("figure"))}});$(document).on("keyup","#chmod_form #chmod_value",function(){chmod_logic(true)});$(document).on("focusout","#chmod_form #chmod_value",function(){var e=$("#chmod_form #chmod_value").val();if(e.match(/^[0-7]{3}$/)==null){var d=$("#chmod_form #chmod_value").attr("data-def-value");$("#chmod_form #chmod_value").val(d);chmod_logic(true)}})});function create_text_file(){$("#textfile_create_area").parent().parent().remove();var a=$("#lang_filename").val()+': <input type="text" id="create_text_file_name" style="min-height:30px"><br><hr><textarea id="textfile_create_area" style="width:100%;height:150px;"></textarea>';bootbox.dialog(a,[{label:$("#cancel").val(),"class":"btn"},{label:$("#ok").val(),"class":"btn-inverse",callback:function(){var e=$("#create_text_file_name").val();var b=$("#textfile_create_area").val();if(e!==null){e=fix_filename(e);var d=$("#sub_folder").val()+$("#fldr_value").val()+e;var c=$("#cur_dir_thumb").val()+e;$.ajax({type:"POST",url:"execute.php?action=create_file",data:{path:d,path_thumb:c,name:e,new_content:b}}).done(function(f){if(f!=""){bootbox.alert(f,function(g){setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+new Date().getTime()},500)})}})}}}],{header:$("#lang_new_file").val()})}function edit_text_file(b){$("#textfile_edit_area").parent().parent().remove();var a=b.find(".rename-file").attr("data-thumb");var c=b.find(".rename-file").attr("data-path");$.ajax({type:"POST",url:"ajax_calls.php?action=get_file&sub_action=edit",data:{path:c}}).done(function(d){bootbox.dialog(d,[{label:$("#cancel").val(),"class":"btn"},{label:$("#ok").val(),"class":"btn-inverse",callback:function(){var e=$("#textfile_edit_area").val();$.ajax({type:"POST",url:"execute.php?action=save_text_file",data:{path:c,path_thumb:a,new_content:e}}).done(function(f){if(f!=""){bootbox.alert(f)}})}}],{header:b.find(".name_download").val()})})}function change_lang(){$.ajax({type:"POST",url:"ajax_calls.php?action=get_lang",data:{}}).done(function(a){bootbox.dialog(a,[{label:$("#cancel").val(),"class":"btn"},{label:$("#ok").val(),"class":"btn-inverse",callback:function(){var b=$("#new_lang_select option:selected").val();$.ajax({type:"POST",url:"ajax_calls.php?action=change_lang",data:{choosen_lang:b}}).done(function(c){if(c!=""){bootbox.alert(c)}else{setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+new Date().getTime()},500)}})}}],{header:$("#lang_lang_change").val()})})}function chmod(b){$("#files_permission_start").parent().parent().remove();if(!b.hasClass("directory")){var a=b.find(".rename-file").attr("data-thumb");var c=b.find(".rename-file").attr("data-path")}else{var a=b.find(".rename-folder").attr("data-thumb");var c=b.find(".rename-folder").attr("data-path")}$.ajax({type:"POST",url:"ajax_calls.php?action=chmod",data:{path:c,path_thumb:a}}).done(function(d){bootbox.dialog(d,[{label:$("#cancel").val(),"class":"btn"},{label:$("#ok").val(),"class":"btn-inverse",callback:function(){var e=$("#chmod_form #chmod_value").val();if(e!=""&&typeof e!=="undefined"){var f=$("#chmod_form input[name=apply_recursive]:checked").val();if(f==""||typeof f==="undefined"){f="none"}$.ajax({type:"POST",url:"execute.php?action=chmod",data:{path:c,path_thumb:a,new_mode:e,is_recursive:f}}).done(function(g){if(g!=""){bootbox.alert(g)}})}}}],{header:$("#lang_file_permission").val()})})}function chmod_logic(a){var b=[];b.user=0;b.group=0;b.all=0;if(typeof a!=="undefined"&&a==true){var c=$("#chmod_form #chmod_value").val();b.user=c.substr(0,1);b.group=c.substr(1,1);b.all=c.substr(2,1);$.each(b,function(d){if(b[d]==""||$.isNumeric(b[d])==false||(parseInt(b[d])<0||parseInt(b[d])>7)){b[d]="0"}});$("#chmod_form input:checkbox").each(function(){var d=$(this).attr("data-group");var e=$(this).attr("data-value");if(chmod_logic_helper(b[d],e)){$(this).prop("checked",true)}else{$(this).prop("checked",false)}})}else{$("#chmod_form input:checkbox:checked").each(function(){var d=$(this).attr("data-group");var e=$(this).attr("data-value");b[d]=parseInt(b[d])+parseInt(e)});$("#chmod_form #chmod_value").val(b.user.toString()+b.group.toString()+b.all.toString())}}function chmod_logic_helper(a,c){var b=[];b[1]=[1,3,5,7];b[2]=[2,3,6,7];b[4]=[4,5,6,7];a=parseInt(a);c=parseInt(c);if($.inArray(a,b[c])!=-1){return true}else{return false}}function clear_clipboard(){bootbox.confirm($("#lang_clear_clipboard_confirm").val(),$("#cancel").val(),$("#ok").val(),function(a){if(a==true){$.ajax({type:"POST",url:"ajax_calls.php?action=clear_clipboard",data:{}}).done(function(b){if(b!=""){bootbox.alert(b)}else{$("#clipboard").val("0")}toggle_clipboard(false)})}})}function copy_cut_clicked(b,d){if(d!="copy"&&d!="cut"){return}if(!b.hasClass("directory")){var a=b.find(".rename-file").attr("data-thumb");var c=b.find(".rename-file").attr("data-path")}else{var a=b.find(".rename-folder").attr("data-thumb");var c=b.find(".rename-folder").attr("data-path")}$.ajax({type:"POST",url:"ajax_calls.php?action=copy_cut",data:{path:c,path_thumb:a,sub_action:d}}).done(function(e){if(e!=""){bootbox.alert(e)}else{$("#clipboard").val("1");toggle_clipboard(true)}})}function paste_to_this_dir(a){bootbox.confirm($("#lang_paste_confirm").val(),$("#cancel").val(),$("#ok").val(),function(b){if(b==true){if(typeof a!="undefined"){var d=a.find(".rename-folder").attr("data-path");var c=a.find(".rename-folder").attr("data-thumb")}else{var d=$("#sub_folder").val()+$("#fldr_value").val();var c=$("#cur_dir_thumb").val()}$.ajax({type:"POST",url:"execute.php?action=paste_clipboard",data:{path:d,path_thumb:c}}).done(function(e){if(e!=""){bootbox.alert(e)}else{$("#clipboard").val("0");toggle_clipboard(false);setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+new Date().getTime()},300)}})}})}function drag_n_drop_paste(b,d){if(!b.hasClass("directory")){var a=b.find(".rename-file").attr("data-thumb");var c=b.find(".rename-file").attr("data-path")}else{var a=b.find(".rename-folder").attr("data-thumb");var c=b.find(".rename-folder").attr("data-path")}$.ajax({type:"POST",url:"ajax_calls.php?action=copy_cut",data:{path:c,path_thumb:a,sub_action:"cut"}}).done(function(g){if(g!=""){bootbox.alert(g)}else{if(typeof d!="undefined"){var f=d.find(".rename-folder").attr("data-path");var e=d.find(".rename-folder").attr("data-thumb")}else{var f=$("#sub_folder").val()+$("#fldr_value").val();var e=$("#cur_dir_thumb").val()}$.ajax({type:"POST",url:"execute.php?action=paste_clipboard",data:{path:f,path_thumb:e}}).done(function(h){if(h!=""){bootbox.alert(h)}else{$("#clipboard").val("0");toggle_clipboard(false);setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+new Date().getTime()},300)}})}})}function toggle_clipboard(a){if(a==true){$(".paste-here-btn, .clear-clipboard-btn").removeClass("disabled")}else{$(".paste-here-btn, .clear-clipboard-btn").addClass("disabled")}}function fix_colums(a){var c=$(".breadcrumb").width()+a;$(".uploader").css("width",c);if($("#view").val()>0){if($("#view").val()==1){$("ul.grid li, ul.grid figure").css("width","100%")}else{var b=Math.floor(c/380);if(b==0){b=1;$("h4").css("font-size",12)}c=Math.floor((c/b)-3);$("ul.grid li, ul.grid figure").css("width",c)}$("#help").hide()}else{if(Modernizr.touch){$("#help").show()}}}function swipe_reaction(b,d,f,c,a){var e=$(this);if($("#view").val()==0){if(e.attr("toggle")==1){e.attr("toggle",0);e.animate({top:"0px"},{queue:false,duration:300})}else{e.attr("toggle",1);e.animate({top:"-30px"},{queue:false,duration:300})}}}function apply(b,g){if($("#popup").val()==1){var h=window.opener}else{var h=window.parent}var k=$("#cur_dir").val();var i=$("#base_url").val();var d=b.substr(0,b.lastIndexOf("."));var a=b.split(".").pop();a=a.toLowerCase();var j="";var f=new Array("ogg","mp3","wav");var c=new Array("mp4","ogg","webm");if(g!=""){if($("#crossdomain").val()==1){window.parent.postMessage({sender:"filemanager",url:i+k+b,field_id:g},"*")}else{var e=$("#"+g,h.document);e.val(i+k+b).trigger("change");close_window()}}if($.inArray(a,ext_img)>-1){j='<img src="'+i+k+b+'" alt="'+d+'" />'}else{if($.inArray(a,c)>-1){j='<video controls source src="'+i+k+b+'" type="video/'+a+'">'+d+"</video>"}else{if($.inArray(a,f)>-1){if(a=="mp3"){a="mpeg"}j='<audio controls src="'+i+k+b+'" type="audio/'+a+'">'+d+"</audio>"}else{j='<a href="'+i+k+b+'" title="'+d+'">'+d+"</a>"}}}if($("#crossdomain").val()!=1){if(parent.tinymce.majorVersion<4){parent.tinymce.activeEditor.execCommand("mceInsertContent",false,j);parent.tinymce.activeEditor.windowManager.close(parent.tinymce.activeEditor.windowManager.params.mce_window_id)}else{parent.tinymce.activeEditor.insertContent(j);parent.tinymce.activeEditor.windowManager.close()}}}function apply_link(a,f){if($("#popup").val()==1){var b=window.opener}else{var b=window.parent}var d=$("#cur_dir").val();d=d.replace("\\","/");var e=$("#base_url").val();if(f!=""){if($("#crossdomain").val()==1){window.parent.postMessage({sender:"filemanager",url:e+d+a,id:f},"*")}else{var c=$("#"+f,b.document);c.val(e+d+a).trigger("change");close_window()}}else{apply_any(e+d,a)}}function apply_img(a,f){if($("#popup").val()==1){var b=window.opener}else{var b=window.parent}var d=$("#cur_dir").val();d=d.replace("\\","/");var e=$("#base_url").val();if(f!=""){if($("#crossdomain").val()==1){window.parent.postMessage({sender:"filemanager",url:e+d+a,field_id:f},"*")}else{var c=$("#"+f,b.document);c.val(e+d+a).trigger("change");close_window()}}else{apply_any(e+d,a)}}function apply_video(a,f){if($("#popup").val()==1){var b=window.opener}else{var b=window.parent}var d=$("#cur_dir").val();d=d.replace("\\","/");var e=$("#base_url").val();if(f!=""){if($("#crossdomain").val()==1){window.parent.postMessage({sender:"filemanager",url:e+d+a,id:f},"*")}else{var c=$("#"+f,b.document);c.val(e+d+a).trigger("change");close_window()}}else{apply_any(d,a)}}function apply_none(a,b){var c=$('li[data-name="'+a+'"]').find(".preview");if(c.html()!=""&&c.html()!==undefined){$("#full-img").attr("src",decodeURIComponent(c.attr("data-url")));if(c.hasClass("disabled")==false){show_animation();$("#previewLightbox").lightbox()}}else{var c=$('li[data-name="'+a+'"]').find(".modalAV");$("#previewAV").removeData("modal");$("#previewAV").modal({backdrop:"static",keyboard:false});if(c.hasClass("audio")){$(".body-preview").css("height","80px")}else{$(".body-preview").css("height","345px")}$.ajax({url:decodeURIComponent(c.attr("data-url")),success:function(d){$(".body-preview").html(d)}})}return}function apply_any(b,a){if($("#crossdomain").val()==1){return false}b=b.replace("\\","/");if(parent.tinymce.majorVersion<4){parent.tinymce.activeEditor.windowManager.params.setUrl(b+a);parent.tinymce.activeEditor.windowManager.close(parent.tinymce.activeEditor.windowManager.params.mce_window_id)}else{parent.tinymce.activeEditor.windowManager.getParams().setUrl(b+a);parent.tinymce.activeEditor.windowManager.close()}return false}function close_window(){if($("#popup").val()==1){window.close()}else{if(typeof parent.jQuery!=="undefined"&&parent.jQuery){parent.jQuery.fancybox.close()}else{parent.$.fancybox.close()}}}function apply_file_duplicate(b,d){var e=b.parent().parent().parent().parent();e.after("<li class='"+e.attr("class")+"' data-name='"+e.attr("data-name")+"'>"+e.html()+"</li>");var a=e.next();apply_file_rename(a.find("figure"),d);var f=a.find(".download-form");var c="form"+new Date().getTime();f.attr("id",c);f.find(".tip-right").attr("onclick","$('#"+c+"').submit();")}function apply_file_rename(c,b){c.attr("data-name",b);c.parent().attr("data-name",b);c.find("h4").find("a").text(b);var k=c.find("a.link");var e=k.attr("data-file");var f=e.substring(e.lastIndexOf("/")+1);var m=e.substring(e.lastIndexOf(".")+1);k.each(function(){$(this).attr("data-file",encodeURIComponent(b+"."+m))});c.find("img").each(function(){var n=$(this).attr("src");$(this).attr("src",n.replace(f,b+"."+m)+"?time="+new Date().getTime());$(this).attr("alt",b+" thumbnails")});var l=c.find("a.preview");var e=l.attr("data-url");if(typeof e!=="undefined"&&e){l.attr("data-url",e.replace(encodeURIComponent(f),encodeURIComponent(b+"."+m)))}c.parent().attr("data-name",b+"."+m);c.attr("data-name",b+"."+m);c.find(".name_download").val(b+"."+m);var i=c.find("a.rename-file");var h=c.find("a.delete-file");var g=i.attr("data-path");var j=i.attr("data-thumb");var d=g.replace(f,b+"."+m);var a=j.replace(f,b+"."+m);i.attr("data-path",d);i.attr("data-thumb",a);h.attr("data-path",d);h.attr("data-thumb",a)}function apply_folder_rename(c,a){c.attr("data-name",a);c.find("figure").attr("data-name",a);var f=c.find("h4").find("a").text();c.find("h4 > a").text(a);var l=c.find(".folder-link");var b=l.attr("href");var d=$("#fldr_value").val();var i=b.replace("fldr="+d+encodeURIComponent(f),"fldr="+d+encodeURIComponent(a));l.each(function(){$(this).attr("href",i)});var m=c.find("a.delete-folder");var k=c.find("a.rename-folder");var h=k.attr("data-path");var g=k.attr("data-thumb");var j=h.lastIndexOf("/");var e=h.substr(0,j+1)+a;m.attr("data-path",e);k.attr("data-path",e);var j=g.lastIndexOf("/");var e=g.substr(0,j+1)+a;m.attr("data-thumb",e);k.attr("data-thumb",e)}function replace_last(d,c,a){var b=new RegExp(c+"$");return d.replace(b,a)}function replaceDiacritics(b){var b;var d=[/[\300-\306]/g,/[\340-\346]/g,/[\310-\313]/g,/[\350-\353]/g,/[\314-\317]/g,/[\354-\357]/g,/[\322-\330]/g,/[\362-\370]/g,/[\331-\334]/g,/[\371-\374]/g,/[\321]/g,/[\361]/g,/[\307]/g,/[\347]/g];var c=["A","a","E","e","I","i","O","o","U","u","N","n","C","c"];for(var a=0;a<d.length;a++){b=b.replace(d[a],c[a])}return b}function fix_filename(a){if(a!=null){if($("#transliteration").val()=="true"){a=replaceDiacritics(a);a=a.replace(/[^A-Za-z0-9\.\-\[\]\ \_]+/g,"")}a=a.replace('"',"");a=a.replace("'","");a=a.replace("/","");a=a.replace("\\","");a=a.replace(/<\/?[^>]+(>|$)/g,"");return $.trim(a)}return null}function execute_action(e,d,c,b,a,f){if(b!==null){b=fix_filename(b);$.ajax({type:"POST",url:"execute.php?action="+e,data:{path:d,path_thumb:c,name:b.replace("/","")}}).done(function(g){if(g!=""){bootbox.alert(g);return false}else{if(f!=""){window[f](a,b)}}return true})}}function sortUnorderedList(e,f,d){if(typeof e=="string"){e=$(e)}var b=e.find("li.dir");var h=e.find("li.file");var a=[];var i=[];var c=[];var g=[];$.each(b,function(j){var l=$(this);var k=l.find(d).val();if($.isNumeric(k)){k=parseFloat(k);while(typeof a[k]!=="undefined"&&a[k]){k=parseFloat(parseFloat(k)+parseFloat(0.001))}}else{k=k+"a"+l.find("h4 a").attr("data-file")}a[k]=l.html();i.push(k)});$.each(h,function(j){var l=$(this);var k=l.find(d).val();if($.isNumeric(k)){k=parseFloat(k);while(typeof c[k]!=="undefined"&&c[k]){k=parseFloat(parseFloat(k)+parseFloat(0.001))}}else{k=k+"a"+l.find("h4 a").attr("data-file")}c[k]=l.html();g.push(k)});if($.isNumeric(i[0])){i.sort(function(k,j){return parseFloat(k)-parseFloat(j)})}else{i.sort()}if($.isNumeric(g[0])){g.sort(function(k,j){return parseFloat(k)-parseFloat(j)})}else{g.sort()}if(f){i.reverse();g.reverse()}$.each(b,function(j){var k=$(this);k.html(a[i[j]])});$.each(h,function(j){var k=$(this);k.html(c[g[j]])})}function show_animation(){$("#loading_container").css("display","block");$("#loading").css("opacity",".7")}function hide_animation(){$("#loading_container").fadeOut()}function launchEditor(b,a){featherEditor.launch({image:b,url:a});return false};