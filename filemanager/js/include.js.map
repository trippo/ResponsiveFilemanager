{"version":3,"sources":["include.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"include.js","sourcesContent":["(function ($, Modernizr, image_editor)\n{\n  \"use strict\";\n\n  var version = \"9.9.0\";\n  var active_contextmenu = true;\n  var copy_count = 0;\n\n  var delay = (function ()\n  {\n    var timer = 0;\n    return function (callback, ms)\n    {\n      clearTimeout(timer);\n      timer = setTimeout(callback, ms);\n    };\n  })();\n\n  var FileManager = {\n\n    contextActions: {\n\n      copy_url : function($trigger)\n      {\n        var m = $('#base_url').val() + $('#cur_dir').val();\n        var add = $trigger.find('a.link').attr('data-file');\n\n        if (add != \"\" && add != null)\n        {\n          m += add;\n        }\n\n        add = $trigger.find('h4 a.folder-link').attr('data-file');\n\n        if (add != \"\" && add != null)\n        {\n          m += add;\n        }\n\n        bootbox.alert(\n          'URL:<br/>' +\n          '<div class=\"input-append\" style=\"width:100%\">' +\n          '<input id=\"url_text' + copy_count + '\" type=\"text\" style=\"width:80%; height:30px;\" value=\"' + encodeURL(m) + '\" />' +\n          '<button id=\"copy-button' + copy_count + '\" class=\"btn btn-inverse copy-button\" style=\"width:20%; height:30px;\" data-clipboard-target=\"url_text' + copy_count + '\" data-clipboard-text=\"Copy Me!\" title=\"copy\">' +\n          '</button>' +\n          '</div>'\n        );\n\n        $('#copy-button' + copy_count).html('<i class=\"icon icon-white icon-share\"></i> ' + $('#lang_copy').val());\n\n        var client = new ZeroClipboard($('#copy-button' + copy_count));\n\n        client.on(\"ready\", function (readyEvent)\n        {\n\n          client.on(\"wrongFlash noFlash\", function ()\n          {\n            ZeroClipboard.destroy();\n          });\n\n          client.on(\"aftercopy\", function (event)\n          {\n            $('#copy-button' + copy_count).html('<i class=\"icon icon-ok\"></i> ' + $('#ok').val());\n            $('#copy-button' + copy_count).attr('class', 'btn disabled');\n            copy_count++;\n          });\n\n          client.on('error', function (event) {});\n\n        });\n      },\n\n      unzip: function($trigger)\n      {\n        var m = $('#sub_folder').val() + $('#fldr_value').val() + $trigger.find('a.link').attr('data-file');\n        $.ajax({\n          type: \"POST\",\n          url: \"ajax_calls.php?action=extract\",\n          data: {\n            path: m\n          }\n        }).done(function (msg)\n        {\n          if (msg != \"\")\n          {\n            bootbox.alert(msg);\n          }\n          else\n          {\n            window.location.href = $('#refresh').attr('href') + '&' + new Date().getTime();\n          }\n        });\n      },\n\n      edit_img: function($trigger)\n      {\n        var filename = $trigger.attr('data-name');\n        var full_path = $('#base_url_true').val() + $('#cur_dir').val() + filename;\n\n        var aviaryElement = $('#aviary_img');\n\n        aviaryElement.attr('data-name', filename);\n        aviaryElement.attr('src', full_path).load(launchEditor(aviaryElement.attr('id'), full_path));\n      },\n\n      duplicate: function($trigger)\n      {\n        var old_name = $trigger.find('h4').text().trim();\n\n        bootbox.prompt($('#lang_duplicate').val(), $('#cancel').val(), $('#ok').val(), function (name)\n        {\n          if (name !== null)\n          {\n            name = fix_filename(name);\n            if (name != old_name)\n            {\n              var _this = $trigger.find('.rename-file');\n              execute_action('duplicate_file', _this.attr('data-path'), _this.attr('data-thumb'), name, _this, 'apply_file_duplicate');\n            }\n          }\n        }, old_name);\n      },\n\n      copy: function($trigger)\n      {\n        copy_cut_clicked($trigger, 'copy');\n      },\n      cut: function($trigger)\n      {\n        copy_cut_clicked($trigger, 'cut');\n      },\n      paste: function()\n      {\n        paste_to_this_dir();\n      },\n      chmod: function($trigger)\n      {\n        chmod($trigger);\n      },\n      edit_text_file: function($trigger)\n      {\n        edit_text_file($trigger);\n      }\n\n    },\n\n    makeContextMenu: function()\n    {\n      var fm = this;\n\n      $.contextMenu({\n        selector: 'figure:not(.back-directory), .list-view2 figure:not(.back-directory)',\n        autoHide: true,\n        build: function ($trigger)\n        {\n\n          $trigger.addClass('selected');\n\n          var options = {\n            callback: function (key, options)\n            {\n              fm.contextActions[key]($trigger);\n            },\n            items: {}\n          };\n          // tooltip options\n          // edit image/show url\n          if (\n            (\n              $trigger.find('.img-precontainer-mini .filetype').hasClass('png')\n              || $trigger.find('.img-precontainer-mini .filetype').hasClass('jpg')\n              || $trigger.find('.img-precontainer-mini .filetype').hasClass('jpeg')\n            ) && image_editor)\n          {\n            options.items.edit_img = {\n              name: $('#lang_edit_image').val(),\n              icon: \"edit_img\",\n              disabled: false\n            };\n          }\n          options.items.copy_url = {\n            name: $('#lang_show_url').val(),\n            icon: \"url\",\n            disabled: false\n          };\n          // extract\n          if ($trigger.find('.img-precontainer-mini .filetype').hasClass('zip') ||\n            $trigger.find('.img-precontainer-mini .filetype').hasClass('tar') ||\n            $trigger.find('.img-precontainer-mini .filetype').hasClass('gz'))\n          {\n            options.items.unzip = {\n              name: $('#lang_extract').val(),\n              icon: \"extract\",\n              disabled: false\n            };\n          }\n\n          // edit file's content\n          if ($trigger.find('.img-precontainer-mini .filetype').hasClass('edit-text-file-allowed'))\n          {\n            options.items.edit_text_file = {\n              name: $('#lang_edit_file').val(),\n              icon: \"edit\",\n              disabled: false\n            };\n          }\n\n          // duplicate\n          if (!$trigger.hasClass('directory') && $('#duplicate').val() == 1)\n          {\n            options.items.duplicate = {\n              name: $('#lang_duplicate').val(),\n              icon: \"duplicate\",\n              disabled: false\n            };\n          }\n\n          // copy & cut\n          if (!$trigger.hasClass('directory') && $('#copy_cut_files_allowed').val() == 1)\n          {\n            options.items.copy = {\n              name: $('#lang_copy').val(),\n              icon: \"copy\",\n              disabled: false\n            };\n            options.items.cut = {\n              name: $('#lang_cut').val(),\n              icon: \"cut\",\n              disabled: false\n            };\n          }\n          else if ($trigger.hasClass('directory') && $('#copy_cut_dirs_allowed').val() == 1)\n          {\n            options.items.copy = {\n              name: $('#lang_copy').val(),\n              icon: \"copy\",\n              disabled: false\n            };\n            options.items.cut = {\n              name: $('#lang_cut').val(),\n              icon: \"cut\",\n              disabled: false\n            };\n          }\n\n          // paste\n          // Its not added to folders because it might confuse someone\n          if ($('#clipboard').val() != 0 && !$trigger.hasClass('directory'))\n          {\n            options.items.paste = {\n              name: $('#lang_paste_here').val(),\n              icon: \"clipboard-apply\",\n              disabled: false\n            };\n          }\n\n          // file permission\n          if (!$trigger.hasClass('directory') && $('#chmod_files_allowed').val() == 1)\n          {\n            options.items.chmod = {\n              name: $('#lang_file_permission').val(),\n              icon: \"key\",\n              disabled: false\n            };\n          }\n          else if ($trigger.hasClass('directory') && $('#chmod_dirs_allowed').val() == 1)\n          {\n            options.items.chmod = {\n              name: $('#lang_file_permission').val(),\n              icon: \"key\",\n              disabled: false\n            };\n          }\n\n          // fileinfo\n          options.items.sep = '----';\n          options.items.info = {\n            name: \"<strong>\" + $('#lang_file_info').val() + \"</strong>\",\n            disabled: true\n          };\n          options.items.name = {\n            name: $trigger.attr('data-name'),\n            icon: 'label',\n            disabled: true\n          };\n          if ($trigger.attr('data-type') == \"img\")\n          {\n            options.items.dimension = {\n              name: $trigger.find('.img-dimension').html(),\n              icon: \"dimension\",\n              disabled: true\n            };\n          }\n          options.items.size = {\n            name: $trigger.find('.file-size').html(),\n            icon: \"size\",\n            disabled: true\n          };\n          options.items.date = {\n            name: $trigger.find('.file-date').html(),\n            icon: \"date\",\n            disabled: true\n          };\n\n\n          return options;\n        },\n        events: {\n          hide: function ()\n          {\n            $('figure').removeClass('selected');\n          }\n        }\n      });\n\n      $(document).on('contextmenu', function (e)\n      {\n        if (!$(e.target).is(\"figure\"))\n        {\n          return false;\n        }\n      });\n    },\n\n    bindGridEvents: function()\n    {\n      var grid = $('ul.grid');\n\n      grid.on('click', '.modalAV', function (e)\n      {\n        var _this = $(this);\n        e.preventDefault();\n\n        var previewElement = $('#previewAV');\n        var bodyPreviewElement = $(\".body-preview\");\n        previewElement.removeData(\"modal\");\n        previewElement.modal({\n          backdrop: 'static',\n          keyboard: false\n        });\n\n        if (_this.hasClass('audio'))\n        {\n          bodyPreviewElement.css('height', '80px');\n        }\n        else\n        {\n          bodyPreviewElement.css('height', '345px');\n        }\n\n        $.ajax({\n          url: _this.attr('data-url'),\n          success: function (data)\n          {\n            bodyPreviewElement.html(data);\n          }\n        });\n      });\n\n      grid.on('click', '.file-preview-btn', function (e)\n      {\n        var _this = $(this);\n        e.preventDefault();\n\n        $.ajax({\n          url: _this.attr('data-url'),\n          success: function (data)\n          {\n            bootbox.alert(data);\n          }\n        });\n      });\n\n      grid.on('click', '.preview', function ()\n      {\n        var _this = $(this);\n        $('#full-img').attr('src', decodeURIComponent(_this.attr('data-url')));\n        return true;\n      });\n\n      grid.on('click', '.rename-file', function ()\n      {\n        var _this = $(this);\n\n        var file_container = _this.parent().parent().parent();\n        var file_title = file_container.find('h4');\n        var old_name = $.trim(file_title.text());\n        bootbox.prompt($('#rename').val(), $('#cancel').val(), $('#ok').val(), function (name)\n        {\n          if (name !== null)\n          {\n            name = fix_filename(name);\n            if (name != old_name)\n            {\n              execute_action('rename_file', _this.attr('data-path'), _this.attr('data-thumb'), name, file_container, 'apply_file_rename');\n            }\n          }\n        }, old_name);\n      });\n\n      grid.on('click', '.rename-folder', function ()\n      {\n        var _this = $(this);\n\n        var file_container = _this.parent().parent().parent();\n        var file_title = file_container.find('h4');\n        var old_name = $.trim(file_title.text());\n        bootbox.prompt($('#rename').val(), $('#cancel').val(), $('#ok').val(), function (name)\n        {\n          if (name !== null)\n          {\n            name = fix_filename(name).replace('.', '');\n            if (name != old_name)\n            {\n              execute_action('rename_folder', _this.attr('data-path'), _this.attr('data-thumb'), name, file_container, 'apply_folder_rename');\n            }\n          }\n        }, old_name);\n      });\n\n      grid.on('click', '.delete-file', function ()\n      {\n        var _this = $(this);\n        bootbox.confirm(_this.attr('data-confirm'), $('#cancel').val(), $('#ok').val(), function (result)\n        {\n          if (result == true)\n          {\n            execute_action('delete_file', _this.attr('data-path'), _this.attr('data-thumb'), '', '', '');\n            _this.parent().parent().parent().parent().remove();\n          }\n        });\n      });\n\n      grid.on('click', '.delete-folder', function ()\n      {\n        var _this = $(this);\n\n        bootbox.confirm(_this.attr('data-confirm'), $('#cancel').val(), $('#ok').val(), function (result)\n        {\n          if (result == true)\n          {\n            execute_action('delete_folder', _this.attr('data-path'), _this.attr('data-thumb'), '', '', '');\n            _this.parent().parent().parent().remove();\n          }\n        });\n      });\n\n      // New link handler\n      function handleFileLink($el)\n      {\n        window[ $el.attr('data-function') ]($el.attr('data-file'), $el.attr('data-field_id'));\n      }\n\n      $('ul.grid .link').on('click', function ()\n      {\n        handleFileLink($(this));\n      });\n\n      $('ul.grid div.box').on('click', function (e)\n      {\n\n        var fileLink = $(this).find(\".link\");\n        if (fileLink.length !== 0)\n        {\n          handleFileLink(fileLink);\n        }\n        else\n        {\n          var folderLink = $(this).find(\".folder-link\");\n          if (folderLink.length !== 0)\n          {\n            document.location = $(folderLink).prop(\"href\");\n          }\n        }\n      });\n      // End of link handler\n    },\n\n    makeFilters: function(js_script)\n    {\n      $('#filter-input').on('keyup', function ()\n      {\n        $('.filters label').removeClass(\"btn-inverse\");\n        $('.filters label').find('i').removeClass('icon-white');\n        $('#ff-item-type-all').addClass(\"btn-inverse\");\n        $('#ff-item-type-all').find('i').addClass('icon-white');\n        var val = fix_filename($(this).val()).toLowerCase();\n        $(this).val(val);\n        if (js_script)\n        {\n          delay(function ()\n          {\n            $('li', 'ul.grid ').each(function ()\n            {\n              var _this = $(this);\n              if (val != \"\" && _this.attr('data-name').toLowerCase().indexOf(val) == -1)\n              {\n                _this.hide(100);\n              }\n              else\n              {\n                _this.show(100);\n              }\n            });\n\n            lazyLoad();\n            $.ajax({\n              url: \"ajax_calls.php?action=filter&type=\" + val\n            }).done(function (msg)\n            {\n              if (msg != \"\")\n              {\n                bootbox.alert(msg);\n              }\n            });\n            delay(function ()\n            {\n              var sortDescending = $('#descending').val() != 0 ? true : false;\n              sortUnorderedList(sortDescending, \".\" + $('#sort_by').val());\n            }, 500);\n\n          }, 300);\n        }\n      }).keypress(function (e)\n      {\n        if (e.which == 13)\n        {\n          $('#filter').trigger('click');\n        }\n      });\n\n      // filtering\n      $('#filter').on('click', function ()\n      {\n        var val = fix_filename($('#filter-input').val());\n        window.location.href = $('#current_url').val() + \"&filter=\" + val;\n      });\n    },\n\n    makeUploader: function()\n    {\n      // upload btn\n      $('#uploader-btn').on('click', function ()\n      {\n        var path = $('#sub_folder').val() + $('#fldr_value').val() + \"/\";\n        path = path.substring(0, path.length - 1);\n\n        $('#iframe-container').html($('<iframe />', {\n          name: 'JUpload',\n          id: 'uploader_frame',\n          src: \"uploader/index.php?path=\" + path,\n          frameborder: 0,\n          width: \"100%\",\n          height: 360\n        }));\n      });\n      $('.upload-btn').on('click', function ()\n      {\n        $('.uploader').show(500);\n      });\n\n      $('.close-uploader').on('click', function ()\n      {\n        $('.uploader').hide(500);\n        setTimeout(function ()\n        {\n          window.location.href = $('#refresh').attr('href') + '&' + new Date().getTime();\n        }, 420);\n      });\n    },\n\n    makeSort: function(js_script)\n    {\n      // sorting\n      $('input[name=radio-sort]').on('click', function ()\n      {\n        var li = $(this).attr('data-item');\n        var liElement = $('#' + li);\n        var labelElement = $('.filters label');\n\n        labelElement.removeClass(\"btn-inverse\");\n        labelElement.find('i').removeClass('icon-white');\n\n        $('#filter-input').val('');\n\n        liElement.addClass(\"btn-inverse\");\n        liElement.find('i').addClass('icon-white');\n\n        if (li == 'ff-item-type-all')\n        {\n          if (js_script)\n          {\n            $('.grid li').show(300);\n          }\n          else\n          {\n            window.location.href = $('#current_url').val() + \"&sort_by=\" + $('#sort_by').val() + \"&descending=\" + (sortDescending ? 1 : 0);\n          }\n        }\n        else\n        {\n          if ($(this).is(':checked'))\n          {\n            $('.grid li').not('.' + li).hide(300);\n            $('.grid li.' + li).show(300);\n          }\n        }\n\n        lazyLoad();\n      });\n      var sortDescending = $('#descending').val();\n      $('.sorter').on('click', function ()\n      {\n        var _this = $(this);\n        if ($('#sort_by').val() === _this.attr('data-sort'))\n        {\n          sortDescending = sortDescending == 0 ? true : false\n        }\n        else\n        {\n          sortDescending = true;\n        }\n\n        if (js_script)\n        {\n          $.ajax({\n            url: \"ajax_calls.php?action=sort&sort_by=\" + _this.attr('data-sort') + \"&descending=\" + (sortDescending ? 1 : 0)\n          });\n          sortUnorderedList(sortDescending, \".\" + _this.attr('data-sort'));\n          $(' a.sorter').removeClass('descending').removeClass('ascending');\n          if (sortDescending)\n          {\n            $('.sort-' + _this.attr('data-sort')).addClass(\"descending\");\n          }\n          else\n          {\n            $('.sort-' + _this.attr('data-sort')).addClass(\"ascending\");\n          }\n\n          $('#sort_by').val(_this.attr('data-sort'));\n          $('#descending').val(sortDescending ? 1 : 0);\n          lazyLoad();\n        }\n        else\n        {\n          window.location.href = $('#current_url').val() + \"&sort_by=\" + _this.attr('data-sort') + \"&descending=\" + (sortDescending ? 1 : 0);\n        }\n      });\n    }\n\n  }\n\n  $(document).ready(function ()\n  {\n    // Right click menu\n    if (active_contextmenu)\n    {\n      FileManager.makeContextMenu();\n    }\n\n    // preview image\n    $('#full-img').on('click', function ()\n    {\n      $('#previewLightbox').lightbox('hide');\n    });\n\n    FileManager.bindGridEvents();\n\n    if (parseInt($('#file_number').val()) > parseInt($('#file_number_limit_js').val()))\n    {\n      var js_script = false;\n    }\n    else\n    {\n      var js_script = true;\n    }\n\n    FileManager.makeSort(js_script);\n    FileManager.makeFilters(js_script);\n\n    // info btn\n    $('#info').on('click', function ()\n    {\n      bootbox.alert('<div class=\"text-center\"><br/><img src=\"img/logo.png\" alt=\"responsive filemanager\"/><br/><br/><p><strong>RESPONSIVE filemanager v.' + version + '</strong><br/><a href=\"http://www.responsivefilemanager.com\">responsivefilemanager.com</a></p><br/><p>Copyright Â© <a href=\"http://www.tecrail.com\" alt=\"tecrail\">Tecrail</a> - Alberto Peripolli. All rights reserved.</p><br/><p>License<br/><small><img alt=\"Creative Commons License\" style=\"border-width:0\" src=\"http://responsivefilemanager.com/license.php\" /><br />This work is licensed under a <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-nc/3.0/\">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>.</small></p></div>');\n    });\n\n    $('#change_lang_btn').on('click', function ()\n    {\n      change_lang();\n    });\n\n    FileManager.makeUploader();\n\n    $('body').on('keypress', function (e)\n    {\n      var c = String.fromCharCode(e.which);\n      if (c == \"'\" || c == '\"' || c == \"\\\\\" || c == '/')\n      {\n        return false;\n      }\n    });\n\n\n\n    $('.create-file-btn').on('click', function ()\n    {\n      create_text_file();\n    });\n\n    $('.new-folder').on('click', function ()\n    {\n      bootbox.prompt($('#insert_folder_name').val(), $('#cancel').val(), $('#ok').val(), function (name)\n      {\n        if (name !== null)\n        {\n          name = fix_filename(name).replace('.', '');\n          var folder_path = $('#sub_folder').val() + $('#fldr_value').val() + name;\n          var folder_path_thumb = $('#cur_dir_thumb').val() + name;\n          $.ajax({\n            type: \"POST\",\n            url: \"execute.php?action=create_folder\",\n            data: {\n              path: folder_path,\n              path_thumb: folder_path_thumb\n            }\n          }).done(function (msg)\n          {\n            setTimeout(function ()\n            {\n              window.location.href = $('#refresh').attr('href') + '&' + new Date().getTime();\n            }, 300);\n\n          });\n        }\n      }, $('#new_folder').val());\n    });\n\n    $('.view-controller button').on('click', function ()\n    {\n      var _this = $(this);\n\n      $('.view-controller button').removeClass('btn-inverse');\n      $('.view-controller i').removeClass('icon-white');\n      _this.addClass('btn-inverse');\n      _this.find('i').addClass('icon-white');\n\n      $.ajax({\n        url: \"ajax_calls.php?action=view&type=\" + _this.attr('data-value')\n      }).done(function (msg)\n      {\n        if (msg != \"\")\n        {\n          bootbox.alert(msg);\n        }\n      });\n      if (typeof  $('ul.grid')[ 0 ] !== \"undefined\" && $('ul.grid')[ 0 ])\n      {\n        $('ul.grid')[ 0 ].className = $('ul.grid')[ 0 ].className.replace(/\\blist-view.*?\\b/g, '');\n      }\n      if (typeof $('.sorter-container')[ 0 ] !== \"undefined\" && $('.sorter-container')[ 0 ])\n      {\n        $('.sorter-container')[ 0 ].className = $('.sorter-container')[ 0 ].className.replace(/\\blist-view.*?\\b/g, '');\n      }\n\n      var value = _this.attr('data-value');\n      $('#view').val(value);\n      $('ul.grid').addClass('list-view' + value);\n      $('.sorter-container').addClass('list-view' + value);\n      if (_this.attr('data-value') >= 1)\n      {\n        fix_colums(14);\n      }\n      else\n      {\n        $('ul.grid li').css(\"width\", 126);\n        $('ul.grid figure').css(\"width\", 122);\n      }\n      lazyLoad();\n    });\n\n    if (!Modernizr.touch)\n    {\n      $('.tip').tooltip({ placement: \"bottom\" });\n      $('.tip-top').tooltip({ placement: \"top\" });\n      $('.tip-left').tooltip({ placement: \"left\" });\n      $('.tip-right').tooltip({ placement: \"right\" });\n      $('body').addClass('no-touch');\n    }\n    else\n    {\n\n      $('#help').show();\n\n      //Enable swiping...\n      $(\".box:not(.no-effect)\").swipe({\n        //Generic swipe handler for all directions\n        swipeLeft: swipe_reaction,\n        swipeRight: swipe_reaction,\n        //Default is 75px, set to 0 for demo so any distance triggers swipe\n        threshold: 30\n      });\n    }\n\n    $('.paste-here-btn').on('click', function ()\n    {\n      if ($(this).hasClass('disabled') == false)\n      {\n        paste_to_this_dir();\n      }\n    });\n\n    $('.clear-clipboard-btn').on('click', function ()\n    {\n      if ($(this).hasClass('disabled') == false)\n      {\n        clear_clipboard();\n      }\n    });\n\n    // reverted to jquery from Modernizr.csstransforms because drag&drop\n    if (!Modernizr.csstransforms)\n    { // Test if CSS transform are supported\n      var figures = $('figure');\n      figures.on('mouseover', function ()\n      {\n        if ($('#view').val() == 0 && $('#main-item-container').hasClass('no-effect-slide') === false)\n        {\n          $(this).find('.box:not(.no-effect)').animate({ top: \"-26px\" }, {\n            queue: false,\n            duration: 300\n          });\n        }\n      });\n\n      figures.on('mouseout', function ()\n      {\n        if ($('#view').val() == 0)\n        {\n          $(this).find('.box:not(.no-effect)').animate({ top: \"0px\" }, {\n            queue: false,\n            duration: 300\n          });\n        }\n      });\n    }\n\n    $(window).resize(function ()\n    {\n      fix_colums(28);\n    });\n    fix_colums(14);\n\n    if ($('#clipboard').val() == 1)\n    {\n      toggle_clipboard(true);\n    }\n    else\n    {\n      toggle_clipboard(false);\n    }\n\n    // Drag & Drop\n    $('li.dir, li.file').draggable({\n      distance: 20,\n      cursor: \"move\",\n\n      helper: function ()\n      {\n        //hack all the way through\n        $(this).find('figure').find('.box').css(\"top\", \"0px\");\n        var ret = $(this).clone().css(\"z-index\", 1000).find('.box').css(\"box-shadow\", \"none\").css(\"-webkit-box-shadow\", \"none\").parent().parent();\n        $(this).addClass('selected');\n        return ret;\n      },\n\n      start: function ()\n      {\n        if ($('#view').val() == 0)\n        {\n          $('#main-item-container').addClass('no-effect-slide');\n        }\n      },\n      stop: function ()\n      {\n        $(this).removeClass('selected');\n        if ($('#view').val() == 0)\n        {\n          $('#main-item-container').removeClass('no-effect-slide');\n        }\n      }\n    });\n\n    $('li.dir,li.back').droppable({\n      accept: \"ul.grid li\",\n      activeClass: \"ui-state-highlight\",\n      hoverClass: \"ui-state-hover\",\n      drop: function (event, ui)\n      {\n        drag_n_drop_paste(ui.draggable.find('figure'), $(this).find('figure'));\n      }\n    });\n\n    // file permissions window\n    $(document).on(\"keyup\", '#chmod_form #chmod_value', function ()\n    {\n      chmod_logic(true);\n    });\n    //safety\n    $(document).on(\"focusout\", '#chmod_form #chmod_value', function ()\n    {\n      var chmodElement = $('#chmod_form #chmod_value');\n      if (chmodElement.val().match(/^[0-7]{3}$/) == null)\n      {\n        chmodElement.val(chmodElement.attr('data-def-value'));\n        chmod_logic(true);\n      }\n    });\n  });\n\n  function create_text_file()\n  {\n    // remove to prevent duplicates\n    $('#textfile_create_area').parent().parent().remove();\n\n    var init_form = $('#lang_filename').val() + ': <input type=\"text\" id=\"create_text_file_name\" style=\"min-height:30px\"><br><hr><textarea id=\"textfile_create_area\" style=\"width:100%;height:150px;\"></textarea>';\n\n    bootbox.dialog(init_form,\n      [\n        {\n          \"label\": $('#cancel').val(),\n          \"class\": \"btn\"\n        },\n        {\n          \"label\": $('#ok').val(),\n          \"class\": \"btn-inverse\",\n          \"callback\": function ()\n          {\n            var newFileName = $('#create_text_file_name').val();\n            var newContent = $('#textfile_create_area').val();\n\n            if (newFileName !== null)\n            {\n              newFileName = fix_filename(newFileName);\n              var folder_path = $('#sub_folder').val() + $('#fldr_value').val() + newFileName;\n              var folder_path_thumb = $('#cur_dir_thumb').val() + newFileName;\n              // post ajax\n              $.ajax({\n                type: \"POST\",\n                url: \"execute.php?action=create_file\",\n                data: {\n                  path: folder_path,\n                  path_thumb: folder_path_thumb,\n                  name: newFileName,\n                  new_content: newContent\n                }\n              }).done(function (status_msg)\n              {\n                if (status_msg != \"\")\n                {\n                  bootbox.alert(status_msg, function (/*result*/)\n                  {\n                    setTimeout(function ()\n                    {\n                      window.location.href = $('#refresh').attr('href') + '&' + new Date().getTime();\n                    }, 500);\n                  });\n                }\n              });\n            }\n          }\n        }\n      ],\n      {\n        \"header\": $('#lang_new_file').val()\n      });\n  }\n\n  function edit_text_file($trigger)\n  {\n    // remove to prevent duplicates\n    $('#textfile_edit_area').parent().parent().remove();\n\n    var thumb_path = $trigger.find('.rename-file').attr('data-thumb');\n    var full_path = $trigger.find('.rename-file').attr('data-path');\n\n    $.ajax({\n      type: \"POST\",\n      url: \"ajax_calls.php?action=get_file&sub_action=edit&preview_mode=text\",\n      data: { path: full_path }\n    }).done(function (init_content)\n    {\n      bootbox.dialog(init_content,\n        [\n          {\n            \"label\": $('#cancel').val(),\n            \"class\": \"btn\"\n          },\n          {\n            \"label\": $('#ok').val(),\n            \"class\": \"btn-inverse\",\n            \"callback\": function ()\n            {\n              var newContent = $('#textfile_edit_area').val();\n              // post ajax\n              $.ajax({\n                type: \"POST\",\n                url: \"execute.php?action=save_text_file\",\n                data: {\n                  path: full_path,\n                  path_thumb: thumb_path,\n                  new_content: newContent\n                }\n              }).done(function (status_msg)\n              {\n                if (status_msg != \"\")\n                {\n                  bootbox.alert(status_msg);\n                }\n              });\n            }\n          }\n        ],\n        {\n          \"header\": $trigger.find('.name_download').val()\n        });\n    });\n  }\n\n  function change_lang()\n  {\n    $.ajax({\n      type: \"POST\",\n      url: \"ajax_calls.php?action=get_lang\",\n      data: {}\n    }).done(function (init_msg)\n    {\n      bootbox.dialog(init_msg,\n        [\n          {\n            \"label\": $('#cancel').val(),\n            \"class\": \"btn\"\n          },\n          {\n            \"label\": $('#ok').val(),\n            \"class\": \"btn-inverse\",\n            \"callback\": function ()\n            {\n              // get new lang\n              var newLang = $('#new_lang_select').val();\n              // post ajax\n              $.ajax({\n                type: \"POST\",\n                url: \"ajax_calls.php?action=change_lang\",\n                data: { choosen_lang: newLang }\n              }).done(function (error_msg)\n              {\n                if (error_msg != \"\")\n                {\n                  bootbox.alert(error_msg);\n                }\n                else\n                {\n                  setTimeout(function ()\n                  {\n                    window.location.href = $('#refresh').attr('href') + '&' + new Date().getTime();\n                  }, 500);\n                }\n              });\n            }\n          }\n        ],\n        {\n          \"header\": $('#lang_lang_change').val()\n        });\n    });\n  }\n\n  function chmod($trigger)\n  {\n    // remove to prevent duplicates\n    $('#files_permission_start').parent().parent().remove();\n\n    var thumb_path, full_path;\n\n    if (!$trigger.hasClass('directory'))\n    {\n      thumb_path = $trigger.find('.rename-file').attr('data-thumb');\n      full_path = $trigger.find('.rename-file').attr('data-path');\n    }\n    else\n    {\n      thumb_path = $trigger.find('.rename-folder').attr('data-thumb');\n      full_path = $trigger.find('.rename-folder').attr('data-path');\n    }\n\n    // ajax -> box -> ajax -> box -> mind blown\n    $.ajax({\n      type: \"POST\",\n      url: \"ajax_calls.php?action=chmod\",\n      data: {\n        path: full_path,\n        path_thumb: thumb_path\n      }\n    }).done(function (init_msg)\n    {\n      bootbox.dialog(init_msg,\n        [\n          {\n            \"label\": $('#cancel').val(),\n            \"class\": \"btn\"\n          },\n          {\n            \"label\": $('#ok').val(),\n            \"class\": \"btn-inverse\",\n            \"callback\": function ()\n            {\n              // get new perm\n              var newPerm = $('#chmod_form #chmod_value').val();\n              if (newPerm != '' && typeof newPerm !== \"undefined\")\n              {\n                // get recursive option if any\n                var recOpt = $('#chmod_form input[name=apply_recursive]:checked').val();\n                if (recOpt == '' || typeof recOpt === \"undefined\")\n                {\n                  recOpt = 'none';\n                }\n\n                // post ajax\n                $.ajax({\n                  type: \"POST\",\n                  url: \"execute.php?action=chmod\",\n                  data: {\n                    path: full_path,\n                    path_thumb: thumb_path,\n                    new_mode: newPerm,\n                    is_recursive: recOpt\n                  }\n                }).done(function (status_msg)\n                {\n                  if (status_msg != \"\")\n                  {\n                    bootbox.alert(status_msg);\n                  }\n                });\n              }\n            }\n          }\n        ],\n        {\n          \"header\": $('#lang_file_permission').val()\n        });\n    });\n  }\n\n  function chmod_logic(is_text)\n  {\n    var perm = [];\n    perm[ 'user' ] = 0;\n    perm[ 'group' ] = 0;\n    perm[ 'all' ] = 0;\n\n    // value was set by text input\n    if (typeof is_text !== \"undefined\" && is_text == true)\n    {\n      // assign values\n      var newperm = $('#chmod_form #chmod_value').val();\n      perm[ 'user' ] = newperm.substr(0, 1);\n      perm[ 'group' ] = newperm.substr(1, 1);\n      perm[ 'all' ] = newperm.substr(2, 1);\n\n      // check values for errors (empty,not num, not 0-7)\n      $.each(perm, function (index)\n      {\n        if (perm[ index ] == '' ||\n          $.isNumeric(perm[ index ]) == false ||\n          (parseInt(perm[ index ]) < 0 || parseInt(perm[ index ]) > 7))\n        {\n          perm[ index ] = \"0\";\n        }\n      });\n\n      // update checkboxes\n      $('#chmod_form input:checkbox').each(function ()\n      {\n        var group = $(this).attr('data-group');\n        var val = $(this).attr('data-value');\n\n        if (chmod_logic_helper(perm[ group ], val))\n        {\n          $(this).prop('checked', true);\n        }\n        else\n        {\n          $(this).prop('checked', false);\n        }\n      });\n\n    }\n    else\n    { //a checkbox was updated\n      $('#chmod_form input:checkbox:checked').each(function ()\n      {\n        var group = $(this).attr('data-group');\n        var val = $(this).attr('data-value');\n        perm[ group ] = parseInt(perm[ group ]) + parseInt(val);\n      });\n\n      $('#chmod_form #chmod_value').val(perm[ 'user' ].toString() + perm[ 'group' ].toString() + perm[ 'all' ].toString());\n    }\n  }\n\n  function chmod_logic_helper(perm, val)\n  {\n    var valid = [];\n    valid[ 1 ] = [ 1, 3, 5, 7 ];\n    valid[ 2 ] = [ 2, 3, 6, 7 ];\n    valid[ 4 ] = [ 4, 5, 6, 7 ];\n\n    perm = parseInt(perm);\n    val = parseInt(val);\n\n    return ($.inArray(perm, valid[ val ]) != -1);\n  }\n\n  function clear_clipboard()\n  {\n    bootbox.confirm($('#lang_clear_clipboard_confirm').val(), $('#cancel').val(), $('#ok').val(), function (result)\n    {\n      if (result == true)\n      {\n        $.ajax({\n          type: \"POST\",\n          url: \"ajax_calls.php?action=clear_clipboard\",\n          data: {}\n        }).done(function (msg)\n        {\n          if (msg != \"\")\n          {\n            bootbox.alert(msg);\n          }\n          else\n          {\n            $('#clipboard').val('0');\n          }\n          toggle_clipboard(false);\n        });\n      }\n    });\n  }\n\n  function copy_cut_clicked($trigger, atype)\n  {\n    if (atype != 'copy' && atype != 'cut')\n    {\n      return;\n    }\n\n    var thumb_path, full_path;\n\n    if (!$trigger.hasClass('directory'))\n    {\n      thumb_path = $trigger.find('.rename-file').attr('data-thumb');\n      full_path = $trigger.find('.rename-file').attr('data-path');\n    }\n    else\n    {\n      thumb_path = $trigger.find('.rename-folder').attr('data-thumb');\n      full_path = $trigger.find('.rename-folder').attr('data-path');\n    }\n\n    $.ajax({\n      type: \"POST\",\n      url: \"ajax_calls.php?action=copy_cut\",\n      data: {\n        path: full_path,\n        path_thumb: thumb_path,\n        sub_action: atype\n      }\n    }).done(function (msg)\n    {\n      if (msg != \"\")\n      {\n        bootbox.alert(msg);\n      }\n      else\n      {\n        $('#clipboard').val(\"1\");\n        toggle_clipboard(true);\n      }\n    });\n  }\n\n  function paste_to_this_dir(dnd)\n  {\n    bootbox.confirm($('#lang_paste_confirm').val(), $('#cancel').val(), $('#ok').val(), function (result)\n    {\n      if (result == true)\n      {\n        var folder_path, folder_path_thumb;\n        if (typeof dnd != 'undefined')\n        {\n          folder_path = dnd.find('.rename-folder').attr('data-path');\n          folder_path_thumb = dnd.find('.rename-folder').attr('data-thumb');\n        }\n        else\n        {\n          folder_path = $('#sub_folder').val() + $('#fldr_value').val();\n          folder_path_thumb = $('#cur_dir_thumb').val();\n        }\n\n        $.ajax({\n          type: \"POST\",\n          url: \"execute.php?action=paste_clipboard\",\n          data: {\n            path: folder_path,\n            path_thumb: folder_path_thumb\n          }\n        }).done(function (msg)\n        {\n          if (msg != \"\")\n          {\n            bootbox.alert(msg);\n          }\n          else\n          {\n            $('#clipboard').val('0');\n            toggle_clipboard(false);\n            setTimeout(function ()\n            {\n              window.location.href = $('#refresh').attr('href') + '&' + new Date().getTime();\n            }, 300);\n          }\n        });\n      }\n    });\n  }\n\n// Had to separate from copy_cut_clicked & paste_to_this_dir func\n// because of feedback and on error bahhhhh...\n  function drag_n_drop_paste($trigger, dnd)\n  {\n    var obj;\n\n    if (!$trigger.hasClass('directory'))\n    {\n      obj = $trigger.find('.rename-file');\n    }\n    else\n    {\n      obj = $trigger.find('.rename-folder');\n    }\n\n    var thumb_path = obj.attr('data-thumb');\n    var full_path = obj.attr('data-path');\n\n    $trigger.parent().hide(100);\n\n    $.ajax({\n      type: \"POST\",\n      url: \"ajax_calls.php?action=copy_cut\",\n      data: {\n        path: full_path,\n        path_thumb: thumb_path,\n        sub_action: 'cut'\n      }\n    }).done(function (msg)\n    {\n      if (msg != \"\")\n      {\n        bootbox.alert(msg);\n      }\n      else\n      {\n        var folder_path, folder_path_thumb;\n        if (typeof dnd != 'undefined')\n        {\n          if (dnd.hasClass('back-directory'))\n          {\n            folder_path = dnd.find('.path').val();\n            folder_path_thumb = dnd.find('.path_thumb').val();\n          }\n          else\n          {\n            folder_path = dnd.find('.rename-folder').attr('data-path');\n            folder_path_thumb = dnd.find('.rename-folder').attr('data-thumb');\n          }\n        }\n        else\n        {\n          folder_path = $('#sub_folder').val() + $('#fldr_value').val();\n          folder_path_thumb = $('#cur_dir_thumb').val();\n        }\n\n        $.ajax({\n          type: \"POST\",\n          url: \"execute.php?action=paste_clipboard\",\n          data: {\n            path: folder_path,\n            path_thumb: folder_path_thumb\n          }\n        }).done(function (msg)\n        {\n          if (msg != \"\")\n          {\n            bootbox.alert(msg);\n            $trigger.parent().show(100);\n          }\n          else\n          {\n            $('#clipboard').val('0');\n            toggle_clipboard(false);\n            $trigger.parent().remove();\n          }\n        });\n      }\n    })\n      .error(function (/*err*/)\n      {\n        $trigger.parent().show(100);\n      });\n  }\n\n  function toggle_clipboard(lever)\n  {\n    if (lever == true)\n    {\n      $('.paste-here-btn, .clear-clipboard-btn').removeClass('disabled');\n    }\n    else\n    {\n      $('.paste-here-btn, .clear-clipboard-btn').addClass('disabled');\n    }\n  }\n\n  function fix_colums(adding)\n  {\n    var width = $('.breadcrumb').width() + adding;\n\n    var viewElement = $('#view');\n    var helpElement = $('#help');\n\n    $('.uploader').css('width', width);\n    if (viewElement.val() > 0)\n    {\n      if (viewElement.val() == 1)\n      {\n        $('ul.grid li, ul.grid figure').css(\"width\", '100%');\n      }\n      else\n      {\n        var col = Math.floor(width / 380);\n        if (col == 0)\n        {\n          col = 1;\n          $('h4').css('font-size', 12);\n        }\n        width = Math.floor((width / col) - 3);\n        $('ul.grid li, ul.grid figure').css(\"width\", width);\n      }\n      helpElement.hide();\n    }\n    else\n    {\n      if (Modernizr.touch)\n      {\n        helpElement.show();\n      }\n    }\n  }\n\n  function swipe_reaction(/*event, direction, distance, duration, fingerCount*/)\n  {\n    var _this = $(this);\n\n    if ($('#view').val() == 0)\n    {\n      if (_this.attr('toggle') == 1)\n      {\n        _this.attr('toggle', 0);\n        _this.animate({ top: \"0px\" }, {\n          queue: false,\n          duration: 300\n        });\n      }\n      else\n      {\n        _this.attr('toggle', 1);\n        _this.animate({ top: \"-30px\" }, {\n          queue: false,\n          duration: 300\n        });\n      }\n\n    }\n  }\n\n  function encodeURL(url)\n  {\n    var tmp = url.split('/');\n    for (var i = 3; i < tmp.length; i++)\n    {\n      tmp[ i ] = encodeURIComponent(tmp[ i ]);\n    }\n    return tmp.join('/');\n  }\n\n  function apply(file, external)\n  {\n    var windowParent;\n\n    if ($('#popup').val() == 1)\n    {\n      windowParent = window.opener;\n    }\n    else\n    {\n      windowParent = window.parent;\n    }\n    var path = $('#cur_dir').val();\n    //path = path.replace('\\\\', '/');\n    var subdir = $('#subdir').val();\n    var base_url = $('#base_url').val();\n    var alt_name = file.substr(0, file.lastIndexOf('.'));\n    var ext = file.split('.').pop();\n    ext = ext.toLowerCase();\n    var fill = '';\n    var ext_audio = ['ogg', 'mp3', 'wav'];\n    var ext_video = ['mp4', 'ogg', 'webm'];\n    var is_return_relative_url = $('#return_relative_url').val();\n    var url = encodeURL((is_return_relative_url == 1 ? subdir : base_url + path) + file);\n\n    if (external != \"\")\n    {\n      if ($('#crossdomain').val() == 1)\n      {\n        windowParent.postMessage({\n            sender: 'responsivefilemanager',\n            url: url,\n            field_id: external\n          },\n          '*'\n        );\n      }\n      else\n      {\n        var target = $('#' + external, windowParent.document);\n        target.val(url).trigger('change');\n        if (typeof windowParent.responsive_filemanager_callback == 'function')\n        {\n          windowParent.responsive_filemanager_callback(external);\n        }\n        close_window();\n      }\n    }\n    else\n    {\n      if ($.inArray(ext, ext_img) > -1)\n      {\n        fill = '<img src=\"' + url + '\" alt=\"' + alt_name + '\" />';\n      }\n      else\n      {\n        if ($.inArray(ext, ext_video) > -1)\n        {\n          fill = '<video controls source src=\"' + url + '\" type=\"video/' + ext + '\">' + alt_name + '</video>';\n        }\n        else\n        {\n          if ($.inArray(ext, ext_audio) > -1)\n          {\n            if (ext == 'mp3')\n            {\n              ext = 'mpeg';\n            }\n            fill = '<audio controls src=\"' + url + '\" type=\"audio/' + ext + '\">' + alt_name + '</audio>';\n          }\n          else\n          {\n            fill = '<a href=\"' + url + '\" title=\"' + alt_name + '\">' + alt_name + '</a>';\n          }\n        }\n\n      }\n\n      if ($('#crossdomain').val() == 1)\n      {\n        windowParent.postMessage({\n            sender: 'responsivefilemanager',\n            url: url,\n            field_id: null,\n            html: fill\n          },\n          '*'\n        );\n\n      }\n      else\n      {\n        // tinymce 3.X\n        if (parent.tinymce.majorVersion < 4)\n        {\n          parent.tinymce.activeEditor.execCommand('mceInsertContent', false, fill);\n          parent.tinymce.activeEditor.windowManager.close(parent.tinymce.activeEditor.windowManager.params.mce_window_id);\n        }\n        // tinymce 4.X\n        else\n        {\n          parent.tinymce.activeEditor.insertContent(fill);\n          parent.tinymce.activeEditor.windowManager.close();\n        }\n      }\n    }\n  }\n\n\n  function apply_link(file, external)\n  {\n    if ($('#popup').val() == 1)\n    {\n      var window_parent = window.opener;\n    }\n    else\n    {\n      var window_parent = window.parent;\n    }\n    var path = $('#cur_dir').val();\n    path = path.replace('\\\\', '/');\n    var subdir = $('#subdir').val();\n    subdir = subdir.replace('\\\\', '/');\n    var base_url = $('#base_url').val();\n    var is_return_relative_url = $('#return_relative_url').val();\n    var url = encodeURL((is_return_relative_url == 1 ? subdir : base_url + path) + file);\n\n    if (external != \"\")\n    {\n      if ($('#crossdomain').val() == 1)\n      {\n        window_parent.postMessage({\n            sender: 'responsivefilemanager',\n            url: url,\n            field_id: external\n          },\n          '*'\n        );\n      }\n      else\n      {\n        var target = $('#' + external, window_parent.document);\n        target.val(url).trigger('change');\n        if (typeof window_parent.responsive_filemanager_callback == 'function')\n        {\n          window_parent.responsive_filemanager_callback(external);\n        }\n        close_window();\n      }\n    }\n    else\n    {\n      apply_any(url);\n    }\n  }\n\n  function apply_img(file, external)\n  {\n    var windowParent;\n\n    if ($('#popup').val() == 1)\n    {\n      windowParent = window.opener;\n    }\n    else\n    {\n      windowParent = window.parent;\n    }\n    var path = $('#cur_dir').val();\n    path = path.replace('\\\\', '/');\n    var subdir = $('#subdir').val();\n    subdir = subdir.replace('\\\\', '/');\n    var base_url = $('#base_url').val();\n    var is_return_relative_url = $('#return_relative_url').val();\n    var url = encodeURL((is_return_relative_url == 1 ? subdir : base_url + path) + file);\n\n    if (external != \"\")\n    {\n      if ($('#crossdomain').val() == 1)\n      {\n        windowParent.postMessage({\n            sender: 'responsivefilemanager',\n            url: url,\n            field_id: external\n          },\n          '*'\n        );\n      }\n      else\n      {\n        var target = $('#' + external, windowParent.document);\n        target.val(url).trigger('change');\n        if (typeof windowParent.responsive_filemanager_callback == 'function')\n        {\n          windowParent.responsive_filemanager_callback(external);\n        }\n        close_window();\n      }\n    }\n    else\n    {\n      apply_any(url);\n    }\n  }\n\n  function apply_video(file, external)\n  {\n    var windowParent;\n    if ($('#popup').val() == 1)\n    {\n      windowParent = window.opener;\n    }\n    else\n    {\n      windowParent = window.parent;\n    }\n    var path = $('#cur_dir').val();\n    path = path.replace('\\\\', '/');\n    var subdir = $('#subdir').val();\n    subdir = subdir.replace('\\\\', '/');\n    var base_url = $('#base_url').val();\n    var is_return_relative_url = $('#return_relative_url').val();\n    var url = encodeURL((is_return_relative_url == 1 ? subdir : base_url + path) + file);\n\n    if (external != \"\")\n    {\n      if ($('#crossdomain').val() == 1)\n      {\n        windowParent.postMessage({\n            sender: 'responsivefilemanager',\n            url: url,\n            field_id: external\n          },\n          '*'\n        );\n      }\n      else\n      {\n        var target = $('#' + external, windowParent.document);\n        target.val(url).trigger('change');\n        if (typeof windowParent.responsive_filemanager_callback == 'function')\n        {\n          windowParent.responsive_filemanager_callback(external);\n        }\n        close_window();\n      }\n    }\n    else\n    {\n      apply_any(url);\n    }\n  }\n\n  function apply_none(file/*, external*/)\n  {\n    var _this = $('li[data-name=\"' + file + '\"]').find('.preview');\n\n    if (_this.html() != \"\" && _this.html() !== undefined)\n    {\n      $('#full-img').attr('src', decodeURIComponent(_this.attr('data-url')));\n      if (_this.hasClass('disabled') == false)\n      {\n        $('#previewLightbox').lightbox();\n      }\n    }\n    else\n    {\n      var _this = $('li[data-name=\"' + file + '\"]').find('a.file-preview-btn');\n      if (_this.html() != \"\" && _this.html() !== undefined)\n      {\n        $.ajax({\n          url: _this.attr('data-url'),\n          success: function (data)\n          {\n            bootbox.alert(data);\n          }\n        });\n      }\n      else\n      {\n        var _this = $('li[data-name=\"' + file + '\"]').find('.modalAV');\n\n        var previewElement = $('#previewAV');\n        var bodyPreviewElement = $(\".body-preview\");\n\n        previewElement.removeData(\"modal\");\n        previewElement.modal({\n          backdrop: 'static',\n          keyboard: false\n        });\n        if (_this.hasClass('audio'))\n        {\n          bodyPreviewElement.css('height', '80px');\n        }\n        else\n        {\n          bodyPreviewElement.css('height', '345px');\n        }\n\n        $.ajax({\n          url: decodeURIComponent(_this.attr('data-url')),\n          success: function (data)\n          {\n            bodyPreviewElement.html(data);\n          }\n        });\n      }\n    }\n  }\n\n  function getUrlParam(paramName)\n  {\n    var reParam = new RegExp('(?:[\\?&]|&)' + paramName + '=([^&]+)', 'i');\n    var match = window.location.search.match(reParam);\n\n    return ( match && match.length > 1 ) ? match[ 1 ] : null;\n  }\n\n  function apply_any(url)\n  {\n    if ($('#crossdomain').val() == 1)\n    {\n      window.parent.postMessage({\n          sender: 'responsivefilemanager',\n          url: url,\n          field_id: null\n        },\n        '*'\n      );\n\n    }\n    else\n    {\n      var editor = $('#editor').val();\n      if (editor == 'ckeditor')\n      {\n        var funcNum = getUrlParam('CKEditorFuncNum');\n        window.opener.CKEDITOR.tools.callFunction(funcNum, url);\n        window.close();\n      }\n      else\n      {\n        // tinymce 3.X\n        if (parent.tinymce.majorVersion < 4)\n        {\n          parent.tinymce.activeEditor.windowManager.params.setUrl(url);\n          parent.tinymce.activeEditor.windowManager.close(parent.tinymce.activeEditor.windowManager.params.mce_window_id);\n        }\n        // tinymce 4.X\n        else\n        {\n          parent.tinymce.activeEditor.windowManager.getParams().setUrl(url);\n          parent.tinymce.activeEditor.windowManager.close();\n        }\n      }\n    }\n  }\n\n  function close_window()\n  {\n    if ($('#popup').val() == 1)\n    {\n      window.close();\n    }\n    else\n    {\n      if (typeof parent.jQuery !== \"undefined\" && parent.jQuery)\n      {\n        parent.jQuery.fancybox.close();\n      }\n      else\n      {\n        parent.$.fancybox.close();\n      }\n    }\n  }\n\n  function apply_file_duplicate(container, name)\n  {\n    var li_container = container.parent().parent().parent().parent();\n\n    li_container.after(\"<li class='\" + li_container.attr('class') + \"' data-name='\" + li_container.attr('data-name') + \"'>\" + li_container.html() + \"</li>\");\n\n    var cont = li_container.next();\n\n    apply_file_rename(cont.find('figure'), name);\n\n    var form = cont.find('.download-form');\n    var new_form_id = 'form' + new Date().getTime();\n\n    form.attr('id', new_form_id);\n    form.find('.tip-right').attr('onclick', \"$('#\" + new_form_id + \"').submit();\");\n  }\n\n  function apply_file_rename(container, name)\n  {\n    var file;\n\n    container.attr('data-name', name);\n    container.parent().attr('data-name', name);\n    container.find('h4').find('a').text(name);\n\n    //select link\n    var link = container.find('a.link');\n\n    file = link.attr('data-file');\n\n    var old_name = file.substring(file.lastIndexOf('/') + 1);\n    var extension = file.substring(file.lastIndexOf('.') + 1);\n\n    link.each(function ()\n    {\n      $(this).attr('data-file', encodeURIComponent(name + \".\" + extension));\n    });\n\n    //thumbnails\n    container.find('img').each(function ()\n    {\n      var src = $(this).attr('src');\n\n      $(this).attr('src', src.replace(old_name, name + \".\" + extension) + '?time=' + new Date().getTime());\n      $(this).attr('alt', name + \" thumbnails\");\n    });\n\n    //preview link\n    var link2 = container.find('a.preview');\n    file = link2.attr('data-url');\n    if (typeof file !== \"undefined\" && file)\n    {\n      link2.attr('data-url', file.replace(encodeURIComponent(old_name), encodeURIComponent(name + \".\" + extension)));\n    }\n\n    //li data-name\n    container.parent().attr('data-name', name + \".\" + extension);\n    container.attr('data-name', name + \".\" + extension);\n\n    //download link\n    container.find('.name_download').val(name + \".\" + extension);\n\n    //rename link && delete link\n    var link3 = container.find('a.rename-file');\n    var link4 = container.find('a.delete-file');\n\n    var path_old = link3.attr('data-path');\n    var path_thumb = link3.attr('data-thumb');\n    var new_path = path_old.replace(old_name, name + \".\" + extension);\n    var new_thumb = path_thumb.replace(old_name, name + \".\" + extension);\n\n    link3.attr('data-path', new_path);\n    link3.attr('data-thumb', new_thumb);\n    link4.attr('data-path', new_path);\n    link4.attr('data-thumb', new_thumb);\n  }\n\n  function apply_folder_rename(container, name)\n  {\n\n    container.attr('data-name', name);\n    container.find('figure').attr('data-name', name);\n\n    var old_name = container.find('h4').find('a').text();\n    container.find('h4 > a').text(name);\n\n    //select link\n    var link = container.find('.folder-link');\n    var url = link.attr('href');\n    var fldr = $('#fldr_value').val();\n    var new_url = url.replace('fldr=' + fldr + encodeURIComponent(old_name), 'fldr=' + fldr + encodeURIComponent(name));\n    link.each(function ()\n    {\n      $(this).attr('href', new_url);\n    });\n\n    //rename link && delete link\n    var link2 = container.find('a.delete-folder');\n    var link3 = container.find('a.rename-folder');\n    var path_old = link3.attr('data-path');\n    var thumb_old = link3.attr('data-thumb');\n    var index = path_old.lastIndexOf('/');\n    var new_path = path_old.substr(0, index + 1) + name;\n    link2.attr('data-path', new_path);\n    link3.attr('data-path', new_path);\n    var index = thumb_old.lastIndexOf('/');\n    var new_path = thumb_old.substr(0, index + 1) + name;\n    link2.attr('data-thumb', new_path);\n    link3.attr('data-thumb', new_path);\n\n  }\n\n  function replace_last(str, find, replace)\n  {\n    var re = new RegExp(find + \"$\");\n    return str.replace(re, replace);\n  }\n\n  function replaceDiacritics(s)\n  {\n    var s;\n\n    var diacritics = [\n      /[\\300-\\306]/g, /[\\340-\\346]/g,  // A, a\n      /[\\310-\\313]/g, /[\\350-\\353]/g,  // E, e\n      /[\\314-\\317]/g, /[\\354-\\357]/g,  // I, i\n      /[\\322-\\330]/g, /[\\362-\\370]/g,  // O, o\n      /[\\331-\\334]/g, /[\\371-\\374]/g,  // U, u\n      /[\\321]/g, /[\\361]/g, // N, n\n      /[\\307]/g, /[\\347]/g // C, c\n    ];\n\n    var chars = [ 'A', 'a', 'E', 'e', 'I', 'i', 'O', 'o', 'U', 'u', 'N', 'n', 'C', 'c' ];\n\n    for (var i = 0; i < diacritics.length; i++)\n    {\n      s = s.replace(diacritics[ i ], chars[ i ]);\n    }\n\n    return s;\n  }\n\n  function fix_filename(stri)\n  {\n    if (stri != null)\n    {\n      if ($('#transliteration').val() == \"true\")\n      {\n        stri = replaceDiacritics(stri);\n        stri = stri.replace(/[^A-Za-z0-9\\.\\-\\[\\] _]+/g, '');\n      }\n      if ($('#convert_spaces').val() == \"true\")\n      {\n        stri = stri.replace(/ /g, $('#replace_with').val());\n        stri = stri.toLowerCase();\n      }\n      stri = stri.replace('\"', '');\n      stri = stri.replace(\"'\", '');\n      stri = stri.replace(\"/\", '');\n      stri = stri.replace(\"\\\\\", '');\n      stri = stri.replace(/<\\/?[^>]+(>|$)/g, \"\");\n      return $.trim(stri);\n    }\n    return null;\n  }\n\n  function execute_action(action, file1, file2, name, container, function_name)\n  {\n    if (name !== null)\n    {\n      name = fix_filename(name);\n      $.ajax({\n        type: \"POST\",\n        url: \"execute.php?action=\" + action,\n        data: {\n          path: file1,\n          path_thumb: file2,\n          name: name.replace('/', '')\n        }\n      }).done(function (msg)\n      {\n        if (msg != \"\")\n        {\n          bootbox.alert(msg);\n          return false;\n        }\n        else\n        {\n          if (function_name != \"\")\n          {\n            window[ function_name ](container, name);\n          }\n        }\n        return true;\n      });\n    }\n  }\n\n\n  function sortUnorderedList(sortDescending, sort_field)\n  {\n    //console.log(sortDescending + \" \" + sort_field);\n\n    var lis_dir = $('li.dir', 'ul.grid').filter(':visible');\n    var lis_file = $('li.file', 'ul.grid').filter(':visible');\n\n    var vals_dir = [];\n    var values_dir = [];\n    var vals_file = [];\n    var values_file = [];\n\n    //Unused\n    //var text = $('#filter-input').val();\n\n    lis_dir.each(function (/*index*/)\n    {\n      var _this = $(this);\n      var value = _this.find(sort_field).val();\n      if ($.isNumeric(value))\n      {\n        value = parseFloat(value);\n        while (typeof vals_dir[ value ] !== \"undefined\" && vals_dir[ value ])\n        {\n          value = parseFloat(parseFloat(value) + parseFloat(0.001));\n        }\n      }\n      else\n      {\n        value = value + \"a\" + _this.find('h4 a').attr('data-file');\n      }\n      vals_dir[ value ] = _this.html();\n      values_dir.push(value);\n    });\n\n    lis_file.each(function (/*index*/)\n    {\n\n      var _this = $(this);\n      var value = _this.find(sort_field).val();\n      console.log(value);\n      if ($.isNumeric(value))\n      {\n        value = parseFloat(value);\n        while (typeof vals_file[ value ] !== \"undefined\" && vals_file[ value ])\n        {\n          value = parseFloat(parseFloat(value) + parseFloat(0.001));\n        }\n      }\n      else\n      {\n        value = value + \"a\" + _this.find('h4 a').attr('data-file');\n      }\n      vals_file[ value ] = _this.html();\n      values_file.push(value);\n    });\n\n    console.log('----------------');\n\n    if ($.isNumeric(values_dir[ 0 ]))\n    {\n      values_dir.sort(function (a, b)\n      {\n        return parseFloat(a) - parseFloat(b);\n      });\n    }\n    else\n    {\n      values_dir.sort();\n    }\n\n    if ($.isNumeric(values_file[ 0 ]))\n    {\n      values_file.sort(function (a, b)\n      {\n        return parseFloat(a) - parseFloat(b);\n      });\n    }\n    else\n    {\n      values_file.sort();\n    }\n\n    if (sortDescending)\n    {\n      values_dir.reverse();\n      values_file.reverse();\n    }\n\n    lis_dir.each(function (index)\n    {\n      var _this = $(this);\n      _this.html(vals_dir[ values_dir[ index ] ]);\n    });\n\n    lis_file.each(function (index)\n    {\n      var _this = $(this);\n      _this.html(vals_file[ values_file[ index ] ]);\n    });\n  }\n\n  function show_animation()\n  {\n    $('#loading_container').css('display', 'block');\n    $('#loading').css('opacity', '.7');\n  }\n\n  function hide_animation()\n  {\n    $('#loading_container').fadeOut();\n  }\n\n  function launchEditor(id, src)\n  {\n    featherEditor.launch({\n      image: id,\n      url: src\n    });\n    return false;\n  }\n\n  function lazyLoad()\n  {\n    $(window).trigger(\"scroll\");\n  }\n\n})(jQuery, Modernizr, image_editor);"],"sourceRoot":"/source/"}